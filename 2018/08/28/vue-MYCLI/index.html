<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> webpack4+Vue搭建自己的Vue-cli · vkcyan</title><meta name="description" content="webpack4+Vue搭建自己的Vue-cli - vkcyan"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yoursite.com/atom.xml" title="vkcyan"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="/about/" target="_self" class="nav-list-link">简历</a></li><li class="nav-list-item"><a href="https://github.com/vkcyan" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">webpack4+Vue搭建自己的Vue-cli</h1><div class="post-info">Aug 28, 2018</div><div class="post-content"><h1 id="webpack4-Vue搭建自己的Vue-cli"><a href="#webpack4-Vue搭建自己的Vue-cli" class="headerlink" title="webpack4+Vue搭建自己的Vue-cli"></a>webpack4+Vue搭建自己的Vue-cli</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近在看webpack4，深感知识浅薄，这两天也一直在思考cli的配置，借助一些别人的实践，尝试自己搭建vue的项目，这里使用webpack4版本，之前我在网上查找别人的vue项目搭建,但是都是webpack3的,所以写了本文，如果有错误,或者有什么问题,请大佬们指出</p>
<p>关于webpack的本文不会多说，请看<a href="https://webpack.docschina.org/concepts/" target="_blank" rel="noopener">webpack文档</a></p>
<p>关于本文的github地址<a href="https://github.com/vkcyan/vue-MYCLI" target="_blank" rel="noopener">vue-MYCLI</a></p>
<h3 id="基础版本"><a href="#基础版本" class="headerlink" title="基础版本"></a>基础版本</h3><p>​    完成了基本的js vue css 的配置 <a href="https://github.com/vkcyan/vue-MYCLI/tree/master" target="_blank" rel="noopener">基础版本</a></p>
<h3 id="完整版本"><a href="#完整版本" class="headerlink" title="完整版本"></a>完整版本</h3><p>​    安装了<strong>vue-router vuex less eslint</strong>,webpack配置已经调整完毕,基本可以使用 <a href="https://github.com/vkcyan/vue-MYCLI/tree/comprehensive" target="_blank" rel="noopener">完整版本</a></p>
<h2 id="前置知识"><a href="#前置知识" class="headerlink" title="前置知识"></a>前置知识</h2><ul>
<li>熟悉 webpack4</li>
<li>熟悉 vue</li>
</ul>
<h2 id="搭建基本骨架"><a href="#搭建基本骨架" class="headerlink" title="搭建基本骨架"></a>搭建基本骨架</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure>
<p>安装webpack4</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack webpack-cli  --save-dev</span><br></pre></td></tr></table></figure>
<p>在开始之前先实验一下环境</p>
<p>根目录新建文件 index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width， initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./src/mian.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>根目录新建文件 src/main.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"我是main"</span>);</span><br></pre></td></tr></table></figure>
<p>根目录新建文件webpack.config.js</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: <span class="string">'./src/main.js'</span>,</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, dist),</span><br><span class="line">    filename: <span class="string">'index.js'</span></span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>打包js文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npx webpack --config webpack.config.js</span><br></pre></td></tr></table></figure>
<p>会看到一些报错,只要构建成功就ok</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/FvWzvWyldX59S6xcQ5_h91n5guHd.png" alt=""></p>
<p>这里说明环境是没有问题的</p>
<h2 id="配置初始生成环境"><a href="#配置初始生成环境" class="headerlink" title="配置初始生成环境"></a>配置初始生成环境</h2><p>开始安装vue-loader吧</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack vue vue-loader -D  //-D就是--save-dev</span><br></pre></td></tr></table></figure>
<p>安装完成后看输出</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/Fq03-XQUwQ933PjfJxmK4BafD9Ws.png" alt=""></p>
<p>提示安装的依赖要安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack css-loader -D</span><br></pre></td></tr></table></figure>
<p>安装完毕后新建src/app.vue</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    你好 &#123;&#123; data &#125;&#125;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        data: &quot;Vue&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure>
<p>.vue文件是无法直接运行的,需要在webpack里面配置loader</p>
<p>这里参照某课的老师的方法,html用webpack生成(后面说明)</p>
<p>在根目录新建index.js  删除index.html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import Vue from 'vue'</span><br><span class="line">import App from './app.vue'</span><br><span class="line"></span><br><span class="line">const root = document.createElement('div')</span><br><span class="line">document.body.appendChild(root)</span><br><span class="line"></span><br><span class="line">new Vue(&#123;</span><br><span class="line">  render: (h) =&gt; h(App)</span><br><span class="line">&#125;).$mount(root)</span><br></pre></td></tr></table></figure>
<p>改写webpack.config.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: path.resolve(__dirname, <span class="string">'src/index.js'</span>), <span class="comment">//关于path模块可以看看阮一峰的教程  http://javascript.ruanyifeng.com/nodejs/path.html#toc0</span></span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'index.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">      loader: <span class="string">'vue-loader'</span></span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在package里面添加脚本</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">"build": "webpack --config webpack.config.js"</span><br></pre></td></tr></table></figure>
<p>控制台运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure>
<p>不出意外会报错</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/FvezeUtSIaOGRZfK0-MO0BYYqztd.png" alt=""></p>
<p>这里有2个问题,一个是没有指定mode 一个是没有引用vue的插件</p>
<p>我们需要改写webpack.config.js,在config里面加一行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mode: &apos;production&apos;,   //暂时指定为生产环境</span><br></pre></td></tr></table></figure>
<p>再次运行<code>npm run build</code> 会报错,需要安装一个包</p>
<blockquote>
<p>这个报错,原本在vue-loader就有提示,不知道为什么现在没有,运行之前报错</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Error: [vue-loader] vue-template-compiler must be installed as a peer dependency, or a compatible compiler implementation must be passed via options</span><br></pre></td></tr></table></figure>
<p>安装vue-template-compiler</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vue-template-compiler -D</span><br></pre></td></tr></table></figure>
<p>再再次运行<code>npm run build</code></p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/Fh7aFnZ-q8ZMeBATz8fguDdIuYyg.png" alt=""></p>
<p>假如按步骤来不除意外这里可以打包成功了<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">我们需要验证打包文件时候是否正确,所以这里使用插件[HtmlWebpackPlugin](https://webpack.docschina.org/plugins/html-webpack-plugin/),帮我们自动创建html文件,并且在后续的hash文件名上很有用,具体可以看官方介绍</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">npm install html-webpack-plugin -D</span><br><span class="line">```</span><br><span class="line"></span><br><span class="line">改webpack.config.js代码</span><br><span class="line"></span><br><span class="line">````JavaScript</span><br><span class="line">const path = require(&apos;path&apos;)</span><br><span class="line">const &#123; VueLoaderPlugin &#125; = require(&apos;vue-loader&apos;)   </span><br><span class="line">var HtmlWebpackPlugin = require(&apos;html-webpack-plugin&apos;);   //引入插件</span><br><span class="line">module.exports = &#123;</span><br><span class="line">  mode: &apos;production&apos;,   //暂时指定为生产环境</span><br><span class="line">  entry: path.resolve(__dirname, &apos;src/index.js&apos;), //关于path模块可以看看阮一峰的教程  http://javascript.ruanyifeng.com/nodejs/path.html#toc0</span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, &apos;dist&apos;),</span><br><span class="line">    filename: &apos;index.js&apos;</span><br><span class="line">  &#125;,</span><br><span class="line">  module: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: /\.vue$/,</span><br><span class="line">      loader: &apos;vue-loader&apos;</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    new VueLoaderPlugin(),</span><br><span class="line">    new HtmlWebpackPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line">````</span><br><span class="line"></span><br><span class="line">`npm run  build`打包一下,dist文件夹下面会有两个文件 </span><br><span class="line"></span><br><span class="line">![](http://on7r0tqgu.bkt.clouddn.com/Fn1OK7lN1Z1qOermZkVRWWLiwrt1.png )</span><br><span class="line"></span><br><span class="line">打包Vue程序完成</span><br></pre></td></tr></table></figure></p>
<p>至此完成了最基本的webpack配置</p>
<p>接下来我们要完成的的配置开发环境</p>
<h2 id="配置开发环境"><a href="#配置开发环境" class="headerlink" title="配置开发环境"></a>配置开发环境</h2><p>关于开发环境以及生成环境,webpack是需要区分的,根据文档<a href="https://webpack.docschina.org/concepts/mode" target="_blank" rel="noopener">模块</a>,我决定在命令里面指定模式,相应的就将开发环境以及生成环境分开,</p>
<p>这里我使用的是提起基本的webpack配置使用<code>webpack-merge</code>这个包来拼接我们webpack配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i webpack-merge -D</span><br></pre></td></tr></table></figure>
<p>修改配置文件</p>
<p>将各各环境的代码区分开,webpack的结构是这样的</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/FiQ5N4R1WuxVe6qikN7CGBRlJKZB.png" alt=""></p>
<p>webpack.config.base.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config =  &#123;</span><br><span class="line">  entry: path.resolve(__dirname, <span class="string">'../src/index.js'</span>), </span><br><span class="line">  output: &#123;</span><br><span class="line">    path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">    filename: <span class="string">'index.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: <span class="regexp">/\.vue$/</span>,</span><br><span class="line">      loader: <span class="string">'vue-loader'</span></span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config</span><br></pre></td></tr></table></figure>
<p>webpack.config.build.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123; VueLoaderPlugin &#125; = <span class="built_in">require</span>(<span class="string">'vue-loader'</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">'./webpack.config.base'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = merge(baseConfig ,&#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> VueLoaderPlugin(),</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config</span><br></pre></td></tr></table></figure>
<p>这里配置开发环境就是重头戏了,我们使用<a href="https://webpack.docschina.org/configuration/dev-server/" target="_blank" rel="noopener">webpack-dev-server</a></p>
<p>webpack-dev-server是一个小型的<code>Node.js Express</code>服务器,代码都跑在内存里面</p>
<p>安装webpack-dev-server</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install webpack-dev-server -D</span><br></pre></td></tr></table></figure>
<p>webpack.config.dev.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"><span class="keyword">const</span> merge = <span class="built_in">require</span>(<span class="string">'webpack-merge'</span>)</span><br><span class="line"><span class="keyword">const</span> baseConfig = <span class="built_in">require</span>(<span class="string">'./webpack.config.base'</span>)</span><br><span class="line"><span class="keyword">const</span> &#123; VueLoaderPlugin &#125; = <span class="built_in">require</span>(<span class="string">'vue-loader'</span>)</span><br><span class="line"><span class="keyword">const</span> HtmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = merge(baseConfig, &#123;</span><br><span class="line">  devServer: &#123;</span><br><span class="line">    port: <span class="string">'8000'</span>,</span><br><span class="line">    host: <span class="string">'localhost'</span>,</span><br><span class="line">    hot: <span class="literal">true</span>, <span class="comment">//热加载</span></span><br><span class="line">    <span class="comment">//quiet: true //控制台中不输出打包的信息</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="keyword">new</span> VueLoaderPlugin(),</span><br><span class="line">    <span class="keyword">new</span> HtmlWebpackPlugin(),</span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br><span class="line">  ]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = config</span><br></pre></td></tr></table></figure>
<p>最后在package里面添加脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;build&quot;: &quot;webpack --mode=production --config build/webpack.config.build.js&quot;,</span><br><span class="line">&quot;dev&quot;: &quot;webpack-dev-server --mode=development --progress --config build/webpack.config.dev.js&quot;</span><br></pre></td></tr></table></figure>
<p>执行<code>npm run dev</code>查看控制台</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/Fr1AoIzHGsIEtdgK1aOaD998W2gn.png" alt=""></p>
<p>这就成功了,在浏览器里面输入<a href="http://localhost:8000/" target="_blank" rel="noopener">http://localhost:8000/</a>,修改app.vue文件,实现了vue-cli的热加载了~~~~</p>
<p>接下来完善一下,不能只有.vue文件的loader,其他的webpack也要认识</p>
<p>我们配置一下图片的loader,以及css的loader,同时css使用postcss进行预处理</p>
<blockquote>
<p>url-loader 用于将文件转换为base64 URI     file-loader是依赖loader</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i url-loader file-loader -D</span><br></pre></td></tr></table></figure>
<p>添加配置webpack.config.base.js&gt;module&gt;rules</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.(gif|png|jpg|svg)$/</span>,</span><br><span class="line">        use: [&#123;</span><br><span class="line">          loader: <span class="string">'url-loader'</span>,</span><br><span class="line">          options: &#123;</span><br><span class="line">            limit: <span class="number">2048</span>,</span><br><span class="line">            name: <span class="string">'resources/[path][name].[hash:8].[ext]'</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;]</span><br><span class="line">      &#125;,</span><br></pre></td></tr></table></figure>
<p>配置css(vue-cli里面的实现非常友好,有机会可以去看看) 下面的是最简单的配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install css-loader -D</span><br><span class="line">npm install vue-style-loader -D</span><br><span class="line">npm install postcss-loader -D</span><br></pre></td></tr></table></figure>
<p>添加配置webpack.config.base.js&gt;module&gt;rules   (postcss不了解谷歌一下)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'vue-style-loader'</span>,</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              sourceMap: <span class="literal">true</span> <span class="comment">//启用源映射支持，postcss-loader将使用其他加载器给出的先前源映射并相应地更新它</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install autoprefixer -D</span><br></pre></td></tr></table></figure>
<p>根目录新建文件postcss.config.js,安装autoprefixer (自动添加浏览器前缀)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> autoprofixer = <span class="built_in">require</span>(<span class="string">'autoprefixer'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    autoprofixer()</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>配置到这里基本的图片以及css就配置完成了,运行一下试试 <code>npm run dev</code></p>
<p>我找src下面创建了assets/img/user.jpg</p>
<p>app.vue</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    你好 &#123;&#123; data &#125;&#125;</span><br><span class="line">    &lt;img src=<span class="string">"./assets/img/user.jpg"</span>&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data()&#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        data: <span class="string">"Vue Cli"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style&gt;</span></span><br><span class="line"><span class="regexp">div&#123;</span></span><br><span class="line"><span class="regexp">  font-size: 20px;</span></span><br><span class="line"><span class="regexp">  color: red;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">img &#123;</span></span><br><span class="line"><span class="regexp">  width: 100px;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br></pre></td></tr></table></figure>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/FjCnn8Jo1O0orp0SrLr-K6-WVETc.png" alt=""></p>
<p>实现了开发环境的图片以及css的配置</p>
<p>打包一下试试</p>
<p>build后生成的目录是这样的</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/Fl1RedxVti_IDXL0uxrHr5aXjJIo.png" alt=""></p>
<p>这不是我们想要的,webpack把代码,类库,css都打包在一起,这样不管是上线还是首屏加载都有影响,所以这里我们要优化webpack</p>
<p>在处理之前想安装一个可以帮助我们每次build之前自动删除上次build生成的文件的插件</p>
<p><code>clean-webpack-plugin</code>这个插件不知道为什么,怎么配置路径都没效果</p>
<p>这里我使用rimraf来进行删除(vue-cli也是使用rimraf,但是他是写在代码里面)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install rimraf -D</span><br></pre></td></tr></table></figure>
<p>在package里面变一下脚本,让打包之前帮我们删除之前到打包文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">"build-webpack"</span>: <span class="string">"webpack --mode=production --config build/webpack.config.build.js"</span>,</span><br><span class="line"><span class="string">"delete"</span>: <span class="string">"rimraf dist"</span>,</span><br><span class="line"><span class="string">"build"</span>: <span class="string">"npm run delete &amp;&amp; npm run build-webpack"</span></span><br></pre></td></tr></table></figure>
<h2 id="分离打包css"><a href="#分离打包css" class="headerlink" title="分离打包css"></a>分离打包css</h2><blockquote>
<p>它会将所有的入口 chunk(entry chunks)中引用的 <code>*.css</code>，移动到独立分离的 CSS 文件 </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install extract-text-webpack-plugin@next -D</span><br></pre></td></tr></table></figure>
<p>因为开发环境和生产环境不一样</p>
<p>我们需要将css部分的代码分环境配置</p>
<ol>
<li>将原先的css配置放到webpack.config.dev.js里面</li>
<li>在webpack.config.build.js里面重写</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123;</span><br><span class="line">    rules: [&#123;</span><br><span class="line">      test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">      use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: <span class="string">"vue-style-loader"</span>,</span><br><span class="line">        use: [</span><br><span class="line">          <span class="string">'css-loader'</span>,</span><br><span class="line">          &#123;</span><br><span class="line">            loader: <span class="string">'postcss-loader'</span>,</span><br><span class="line">            options: &#123;</span><br><span class="line">              sourceMap: <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;]</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
<p>这样的话,我们开发环境不影响依旧是之前到模式,build的时候用ExtractTextPlugin帮我们分离非js文件,实现css的分离打包</p>
<p>我们打包一下试试<code>npm run build</code></p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/Fj_GZsAlIwLICy19Yquq3EuAOYqu.png" alt=""></p>
<h2 id="分离js文件"><a href="#分离js文件" class="headerlink" title="分离js文件"></a>分离js文件</h2><p>接下来是分离js文件,就是将库文件以及我们的代码分离开,利于上线后的浏览器缓存,代码会经常变,库不会经常变</p>
<p>在webpack4之前js分离用的插件是CommonsChunkPlugin,不过这插件现在移除了,现在用的是optimization.splitChunks 来进行公共代码与第三方代码的提取,splitChunks参数如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">    splitChunks: &#123; </span><br><span class="line">      chunks: &quot;initial&quot;,         // 代码块类型 必须三选一： &quot;initial&quot;（初始化） | &quot;all&quot;(默认就是all) | &quot;async&quot;（动态加载） </span><br><span class="line">      minSize: 0,                // 最小尺寸，默认0</span><br><span class="line">      minChunks: 1,              // 最小 chunk ，默认1</span><br><span class="line">      maxAsyncRequests: 1,       // 最大异步请求数， 默认1</span><br><span class="line">      maxInitialRequests: 1,     // 最大初始化请求书，默认1</span><br><span class="line">      name: () =&gt; &#123;&#125;,            // 名称，此选项课接收 function</span><br><span class="line">      cacheGroups: &#123;                // 缓存组会继承splitChunks的配置，但是test、priorty和reuseExistingChunk只能用于配置缓存组。</span><br><span class="line">        priority: &quot;0&quot;,              // 缓存组优先级 false | object |</span><br><span class="line">        vendor: &#123;                   // key 为entry中定义的 入口名称</span><br><span class="line">          chunks: &quot;initial&quot;,        // 必须三选一： &quot;initial&quot;(初始化) | &quot;all&quot; | &quot;async&quot;(默认就是异步)</span><br><span class="line">          test: /react|lodash/,     // 正则规则验证，如果符合就提取 chunk</span><br><span class="line">          name: &quot;vendor&quot;,           // 要缓存的 分隔出来的 chunk 名称</span><br><span class="line">          minSize: 0,</span><br><span class="line">          minChunks: 1,</span><br><span class="line">          enforce: true,</span><br><span class="line">          reuseExistingChunk: true   // 可设置是否重用已用chunk 不再创建新的chunk</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>官方包括这解释,我并不是很看懂,所以打包策略并不是很好</p>
<p>在webpack.config.build.js&gt;config</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">output: &#123;</span><br><span class="line">    filename: <span class="string">'[name].[chunkhash:8].js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">optimization: &#123;</span><br><span class="line">    splitChunks: &#123;</span><br><span class="line">      chunks: <span class="string">"all"</span>,</span><br><span class="line">      cacheGroups: &#123;</span><br><span class="line">        vendor: &#123;</span><br><span class="line">          test: <span class="regexp">/node_modules/</span>,  <span class="comment">//这里虽然分离了,但是没有做到按需引入,看官方配置也不是很明白</span></span><br><span class="line">          name: <span class="string">'vendors'</span>,</span><br><span class="line">          chunks: <span class="string">'all'</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    runtimeChunk: <span class="literal">true</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>build一下查看目录,可以看出代码与库之间分离了</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/Fk0Cs9a1ih6CSaZLhgP80MTO0hWc.png" alt=""></p>
<h2 id="gitignore"><a href="#gitignore" class="headerlink" title=".gitignore"></a>.gitignore</h2><p>这里处理一下git 新建文件.gitignore</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">node_modules/</span><br><span class="line">/dist/</span><br><span class="line">npm-debug.log*</span><br><span class="line">yarn-debug.log*</span><br><span class="line">yarn-error.log*</span><br><span class="line"></span><br><span class="line"># Editor directories and files</span><br><span class="line">.idea</span><br><span class="line">.vscode</span><br><span class="line">*.suo</span><br><span class="line">*.ntvs*</span><br><span class="line">*.njsproj</span><br><span class="line">*.sln</span><br></pre></td></tr></table></figure>
<h2 id="editorconfig"><a href="#editorconfig" class="headerlink" title=".editorconfig,"></a>.editorconfig,</h2><p>处理一下编译器的统一配置</p>
<p>新建文件 .editorconfig,(关于<a href="http://www.alloyteam.com/2014/12/editor-config/" target="_blank" rel="noopener">editorconfig</a>,以及配置解释)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root = true</span><br><span class="line"></span><br><span class="line">[*]</span><br><span class="line">charset = utf-8</span><br><span class="line">indent_style = space</span><br><span class="line">indent_size = 2</span><br><span class="line">end_of_line = lf</span><br><span class="line">insert_final_newline = true</span><br><span class="line">trim_trailing_whitespace = true</span><br></pre></td></tr></table></figure>
<p>还有一点要注意,假如没有效果,vscode需要安装一个插件<code>EditorConfig for VS Code</code>,其他编译器不太清楚</p>
<h2 id="babelrc"><a href="#babelrc" class="headerlink" title=".babelrc"></a>.babelrc</h2><p>处理一下ES6,以及js文件的webpack的loader配置</p>
<blockquote>
<p>今天装了babel-loader8.0.0 报错报一上午,心态都搞崩了,所以这里我使用的是7版本</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel-loader@7 babel-core babel-preset-env -D</span><br></pre></td></tr></table></figure>
<p>在webpack.config.base.js&gt;module&gt;rules里面添加代码</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: <span class="regexp">/\.js$/</span>,</span><br><span class="line">        exclude: <span class="regexp">/node_modules/</span>,</span><br><span class="line">        loader: <span class="string">'babel-loader'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>新建文件 .babelrc</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [</span><br><span class="line">    <span class="string">"env"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>首先检查开发环境</p>
<p>我新建了一个es6语法的js 导入到app.vue里面</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/FmZ8Vjf0BJQwKGz7jqt6XgT36Xom.png" alt=""></p>
<p>运行结果</p>
<p><img src="http://on7r0tqgu.bkt.clouddn.com/FlJhUUj3tL3YkdZ3Gm3AgRxio_Ha.png" alt=""></p>
<h2 id="eslint"><a href="#eslint" class="headerlink" title="eslint"></a>eslint</h2><p>eslint的安装相对简单,可以看<a href="https://github.com/standard/eslint-config-standard" target="_blank" rel="noopener">官方指南</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save-dev eslint eslint-config-standard eslint-plugin-standard eslint-plugin-promise eslint-plugin-import eslint-plugin-node</span><br></pre></td></tr></table></figure>
<p>因为.vue文件不会是纯js代码,所以,我们需要安装额外的解析的插件 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install eslint-plugin-html -D</span><br></pre></td></tr></table></figure>
<p>然后我们配置eslint到我们的项目</p>
<p>在根目录新建文件.eslintrc</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"extends"</span>: <span class="string">"standard"</span>,</span><br><span class="line">  <span class="string">"plugins"</span>: [</span><br><span class="line">    <span class="string">"html"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"rules"</span>: &#123;</span><br><span class="line">    <span class="string">"no-new"</span>: <span class="string">"off"</span>  <span class="comment">//因为new Vue但是eslint默认不许new 我们需要把这个关掉</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在package里面添加两行脚本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;lint&quot;: &quot;eslint --ext .js --ext .jsx --ext .vue src/&quot;,</span><br><span class="line">&quot;lint-fix&quot;: &quot;eslint --fix --ext .js --ext .jsx --ext .vue src/&quot;</span><br></pre></td></tr></table></figure>
<p>现在运行<code>npm run lint</code>即检查项目</p>
<p>运行<code>npm run lint-fix</code>,即是将不规范的地方修正</p>
<p>下一步我们配置到我们的webpack里面让运行的时候同时检查代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install eslint-loader babel-eslint -D</span><br></pre></td></tr></table></figure>
<p>改写配置文件 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;extends&quot;: &quot;standard&quot;,</span><br><span class="line">  &quot;plugins&quot;:[</span><br><span class="line">    &quot;html&quot;</span><br><span class="line">  ],</span><br><span class="line">  &quot;parser&quot;:&quot;babel-eslint&quot;,</span><br><span class="line">  &quot;rules&quot;: &#123;</span><br><span class="line">    &quot;no-new&quot;: &quot;off&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在webpack.config.base里面的module&gt; rules 里面加一个字段 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        test: /\.(vue|js|jsx)$/,</span><br><span class="line">        loader: &apos;eslint-loader&apos;,</span><br><span class="line">        exclude:/node_modules/,</span><br><span class="line">        enforce: &apos;pre&apos;     //预处理</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>至此,基本的vue项目骨架的搭建完毕了,后面还有vue-router 以及vuex less的安装,请查看我的<a href="https://github.com/vkcyan/vue-MYCLI/tree/comprehensive" target="_blank" rel="noopener">github</a>,当然他没有vue-cli那么强大,或许最大的益处是让我们熟悉一个vue项目的大致webpack配置,当然我们可以一步一步的优化项目</p>
</div></article></div></main><footer><div class="paginator"><a href="/2018/09/05/实现一个MVVM框架/" class="prev">上一篇</a><a href="/2018/08/28/vue-router 与 vuex/" class="next">下一篇</a></div><div class="copyright"><p>© 2018 <a href="http://yoursite.com">vkcyan</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>